async function refreshAccessToken(){const t=localStorage.getItem("Logout"),n=localStorage.getItem("refreshToken");if(!n)return!1;try{const i=await fetch("/User/RefreshToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:n})}),r=await i.json();if(i.ok&&r.accessToken)return localStorage.setItem("accessToken",r.accessToken),!0;console.warn("Refresh token failed. Logging out...");localStorage.clear();window.location.href=t}catch(i){return console.error("Error refreshing token:",i),!1}}window.FetchAuthenticate=async(n,t)=>{var i=localStorage.getItem("accessToken");const u=new URLSearchParams(t).toString(),f=`${n}?${u}`,r=async n=>await fetch(f,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}});try{let n=await r(i);const t=localStorage.getItem("Logout");if(n.status===401){const u=await refreshAccessToken();if(u){if(i=localStorage.getItem("accessToken"),n=await r(i),n.status===401){localStorage.clear();window.location.href=t;return}if(n.status===401)return t&&(localStorage.clear(),window.location.href=t),null}else{localStorage.clear();window.location.href=t;return}}return await n.json()}catch(e){console.error("Error fetching data:",e)}};window.fetchData=async(n,t={})=>{console.clear();try{const i=new URLSearchParams(t).toString(),r=i?`${n}?${i}`:n,u=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}});return await u.json()}catch(i){return console.error("Fetch Error:",i),null}};window.postData=async(n,t)=>{console.clear();try{const r=await fetch(n,{method:"POST",body:t}),i=await r.json();return!r.ok||i.Success===!1?(console.error("Server error:",i.Message||"Unknown error"),i):i}catch(i){return console.error("Error posting data:",i),null}};window.postrawData=async(n,t)=>{try{const i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});let r;try{return await i.json()}catch(u){console.error("Error parsing JSON:",u);const n=await i.text();return console.error("Raw response:",n),{Success:!1,Message:"Invalid JSON response",Raw:n}}if(!i.ok||r.Success===!1)return console.error("Server error:",r.Message||"Unknown error"),r}catch(i){return console.error("Error posting data:",i),null}};window.PullUserInformation=async()=>{const i=localStorage.getItem("accessToken"),t=await fetch("/User/GetUserInformation",{method:"POST",headers:{Authorization:"Bearer "+i,"Content-Type":"application/json"}});if(t.status===401){console.warn("Unauthorized");return}const n=await t.json();if(n.success)return n;console.warn(n.message||"Unknown error")};window.IsLoginUser=(n={})=>{const{storageKey:o,expectedValue:f,redirectUrl:t,redirectIfLoggedInUrl:u,expirationKey:i,maxHours:r}={storageKey:"isLoggedInPatrol",expectedValue:"true",redirectUrl:"/PC/Patrol/index",redirectIfLoggedInUrl:null,expirationKey:null,maxHours:null,...n},e=localStorage.getItem(o);if(e===f&&u)if(i&&r){const n=localStorage.getItem(i);if(n){const t=new Date(n),i=new Date,f=Math.abs(i-t)/36e5;if(f<=r){window.location.href=u;return}}}else{window.location.href=u;return}if(e!==f){const n=window.location.pathname,i=n!==t;if(i)if(typeof ActionRestrict=="function"){const n=ActionRestrict();if(n!==!1){window.location.href=t;return}}else{window.location.href=t;return}return}if(i&&r){const n=localStorage.getItem(i),u=window.location.pathname,f=new URL(t,window.location.origin).pathname;if(n){const i=new Date(n),e=new Date,o=Math.abs(e-i)/36e5;o>r&&(localStorage.clear(),u!==f&&(window.location.href=t))}else localStorage.clear(),u!==f&&(window.location.href=t)}};window.logout=async()=>{const n=localStorage.getItem("Logout");try{localStorage.clear();window.location.href=n}catch(t){console.error("Logout failed:",t)}};window.restrictChars=n=>{var t=n.which||n.keycode;return t>=48&&t<=57||t==46?!0:!1};window.ActionButtons=function(){var n=localStorage.getItem("UserRole");if(n==="Leader"||n==="Users")return!1};