<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/x-icon" href="~/Content/Images/capacity.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMACS</title>
    <script src="~/Content/lib/font-awesome/js/all.min.js"></script>
    <link href="~/Content/sweetalert2.min.css" rel="stylesheet" />
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")


</head>
<body>
    <!--========== NAV ==========-->
    <div class="nav" id="navbar">
        <nav class="nav__container">
            <div>
                <a href="#" class="nav__link nav__logo">
                    <i class='bx bxs-disc nav__icon'></i>
                    <span class="nav__logo-name">PMACS</span>
                </a>

                <div class="nav__list">
                    <div class="nav__items">
                        <h3 class="nav__subtitle">Main Menu</h3>

                        <a href="/P1SA/PMACS/ManpowerProduction" class="nav__link active">
                            <i class="fa fa-users nav__icon"></i>
                            <span class="nav__name">Manpower</span>
                        </a>

                        <a href="#" class="nav__link">
                            <i class="fa-solid fa-gears nav__icon"></i>
                            <span class="nav__name">Fan Major</span>
                        </a>

                        <a href="/P1SA/PMACS/Selection" class="nav__link">
                            <i class="fa fa-microchip nav__icon"></i>
                            <span class="nav__name">Capacity Process</span>
                        </a>

                        <a href="/P1SA/PMACS/P1SASummary" class="nav__link">
                            <i class="fa fa-table nav__icon"></i>
                            <span class="nav__name">P1SA summary</span>
                        </a>
                    </div>

                    <div class="nav__items">
                        <h3 class="nav__subtitle">Settings</h3>



                        <a href="#" class="nav__link">
                            <i class='bx bx-compass nav__icon'></i>
                            <span class="nav__name">Change Password</span>
                        </a>
                        <a href="#" class="nav__link">
                            <i class='bx bx-bookmark nav__icon'></i>
                            <span class="nav__name">Saved</span>
                        </a>
                    </div>
                </div>
            </div>

            <a href="#" class="nav__link nav__logout">
                <i class='bx bx-log-out nav__icon'></i>
                <span class="nav__name">Log Out</span>
            </a>
        </nav>
    </div>

    <!--========== CONTENTS ==========-->
    <main>
        @RenderBody()
    </main>

    <!--<div class="mancontainer shrink">
        <nav>
            <div class="sidebar__top">
                <span class="sidebar__btn">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </span>
                <div class="sidebartop__btn">
                    <i class="fa fa-cubes" aria-hidden="true"></i>
                </div>
                <h3 class="hide">PMACS</h3>
            </div>

            <div class="sidebar__links">

                <ul>

                    <li class="tooltip_element" data-tooltip="0">
                        <a href="/P1SA/PMACS/ManpowerProduction" onclick="setActiveLink(0, 'Manpower')" class="nav-link  " data-active="0">
                            <div class="sidebar__icons">
                                <i class="fa fa-users" aria-hidden="true"></i>
                            </div>
                            <span class="sidebar__linksname hide">
                                Manpower
                            </span>
                        </a>
                    </li>

                    <li class="tooltip_element" data-tooltip="1">
                        <a href="/P1SA/PMACS/FanMajor" onclick="setActiveLink(1, 'Fan Major Equipment')" class="nav-link navactive " data-active="1">
                            <div class="sidebar__icons">
                                <i class="fa-solid fa-gears" aria-hidden="true"></i>

                            </div>
                            <span class="sidebar__linksname hide">
                                Fan Major Equipment
                            </span>
                        </a>
                    </li>-->
    @*<li class="tooltip_element" data-tooltip="1">
            <a href="/machine/Fanmajor" onclick="setActiveLink(1, 'Fan Major Equipment')" class="nav-link active " data-active="1">
                <div class="sidebar__icons">
                    <i class="fa-solid fa-gears" aria-hidden="true"></i>
                    <i class="fa-solid fa-gears" aria-hidden="true"></i>
                </div>
                <span class="sidebar__linksname hide">
                    Capacity per week
                </span>
            </a>
        </li>*@




    <!--<li class="tooltip_element" data-tooltip="2">
        <a href="/P1SA/PMACS/Selection" onclick="setActiveLink(2, 'Capacity per Process')" class="nav-link  " data-active="2">
            <div class="sidebar__icons">
                <i class="fa fa-microchip" aria-hidden="true"></i>

            </div>
            <span class="sidebar__linksname hide">
                Capacity per Process
            </span>
        </a>
    </li>


    <li class="tooltip_element" data-tooltip="3">
        <a href="/P1SA/PMACS/P1SASummary" onclick="setActiveLink(3, 'P1SA Summary')" class="nav-link " data-active="3">
            <div class="sidebar__icons">
                <i class="fa fa-table" aria-hidden="true"></i>

            </div>
            <span class="sidebar__linksname hide">
                PISA summary
            </span>
        </a>
    </li>-->
    @*<li class="tooltip_element" id="Userhide" data-tooltip="4">
            <a href="/User/ProfileUser" onclick="setActiveLink(4, 'Account Settings')" class="nav-link " data-active="4">
                <div class="sidebar__icons">
                    <i class="fa-regular fa-circle-user"></i>

                </div>
                <span class="sidebar__linksname hide">
                    Account Settings
                </span>
            </a>
        </li>*@
    @*
        <div class="tooltip">
            <span class="show">Dashboard</span>
            <span>fan major</span>
            <span>Capacity</span>
            <span>user setting</span>
        </div>*@
    <!--</ul>


    </div>

    <div class="sidebar__footer">-->
    @*
        <a href="#" class="sidebar__account">
            <i class="bx bx-user"></i>
        </a>*@
    <!--<div class="sidebar__user">
                    <div class="sidebar__userprofile">

                        <div class="sidebard__userinfo">
                            <h3 id="fullnametext">John Doe</h3>
                            <h5 id="Roles">User Guest</h5>
                        </div>
                    </div>
                    <a href="#" id="logbtn" class="sidebar__logout" title="logouttext">
                        <i class="fa fa-sign-out" aria-hidden="true"></i>
                    </a>
                </div>
            </div>
        </nav>

        <main>

        </main>
    </div>-->
    @*<div id="notification" class="notification">
            <div class="notification-container">
                <div class="notification-header">
                    <h2>System Update</h2>
                </div>
                <div class="notification-content">
                    <div class="notification-version">
                        <h3>New Features:</h3>
                        <p>Version</p>
                    </div>
                    <ul id="features-list">
                        <li>1. Improve performance</li>
                        <li>2. Fix Molding Frame Capacity process</li>
                        <li>3. Fix Balancing Capacity process</li>
                    </ul>

                    <div class="notification-footer">
                        <button id="close-btn">Close</button>

                    </div>
                </div>
            </div>
        </div>*@

    <script src="~/Scripts/Utilities.js"></script>
    <script src="~/Scripts/jquery-3.7.1.js"></script>
    <script type="text/javascript">
        @*const sidebtn = document.querySelector(".sidebar__btn");
        const sidebar__links = document.querySelectorAll(".sidebar__links a");
        const logs = document.querySelector("#logbtn");
        const tooltip_elements = document.querySelectorAll(".tooltip_element");

        let activeindex;

        LoadUpdates();
        //fetchData();



         const Getuserinfoname = async () =>{
             let res = await fetchData('@Url.Action("GetUsersinfo", "User")', {});
             $("#fullnametext").text(res);
         }






        function fetchData() {

            let index = localStorage.getItem('users');
            var parsedObject = JSON.parse(index);

            if (localStorage.getItem('users') !== null) {
                $("#fullnametext").text(parsedObject.Fullname);
                $("#Roles").text(parsedObject.Position);
                if (parsedObject.Roles_ID === 2) {
                    $("#Userhide").hide();
                }

            } else {
                //window.location.href = "/User/PMACSMainpage";
            }
        }
        function LoadUpdates() {
            // New system version
            const newVersion = "@ViewBag.Version"; // Change this value when there's a new system update

            // Get the stored version from localStorage
            const storedVersion = localStorage.getItem('systemVersion');

            // Check if the version has changed
            if (storedVersion !== newVersion) {
                // Show notification if the version has changed
                const notification = document.getElementById('notification');
                notification.style.display = 'flex';

                // Update the stored version to the new one
                localStorage.setItem('systemVersion', newVersion);
            }

            // Close notification when the close button is clicked
            const closeBtn = document.getElementById('close-btn');
            closeBtn.addEventListener('click', function () {
                const notification = document.getElementById('notification');
                notification.style.display = 'none';
            });

        }



        sidebtn.addEventListener("click", () => {
            let sidecon = document.querySelector(".mancontainer")
            sidecon.classList.toggle("shrink");
            sidebtn.classList.add("hovered");

            setTimeout(() => {
                sidebtn.classList.remove("hovered");
            }, 500);
        });



        function changeLink() {
            sidebar__links.forEach(sidelink => sidelink.classList.remove("navactive"));
            this.classList.add("navactive");
            activeindex = this.dataset.active;
            //moveActiveTab();
        }
        sidebar__links.forEach(link => link.addEventListener("click", changeLink));

        logs.addEventListener("click", () => {
            Swal.fire({
                title: "Sign out ?",
                text: "Are you sure you want to sign out?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#a3a3a3",
                confirmButtonText: "Log out"
            }).then(async (result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    //let res = await postData("/User/Logout", {});
                    localStorage.removeItem('activeLinkIndex');
                    localStorage.removeItem('users');
                    window.location.href = "/User/Logout";
                }
            });
        });

        // Function to set active link and store it in localStorage
        function setActiveLink(index, link) {
            // Remove active class from all links
            let links = document.querySelectorAll('.nav-link');
            links.forEach(link => {
                link.classList.remove('navactive');
            });
            // Add active class to the clicked link
            links[index].classList.add('navactive');
            // Store the active link index in localStorage
            localStorage.setItem('activeLinkIndex', index);
        }

        // Function to set active link based on stored value in localStorage
        function setActiveLinkFromStorage() {

            let index = localStorage.getItem('activeLinkIndex');

            if (index !== null) {
                // Remove active class from all links
                let links = document.querySelectorAll('.nav-link');
                links.forEach(link => {
                    link.classList.remove('navactive');
                });
                // Add active class to the link with stored index
                links[parseInt(index)].classList.add('navactive');



            } else {
                let links = document.querySelectorAll('.nav-link');
                links.forEach(link => {
                    link.classList.remove('navactive');
                });
                localStorage.setItem('activeLinkIndex', 1);
                links[0].classList.add('navactive');
            }
        }

        Getuserinfoname();
        // Call the function when the page loads
        window.onload = setActiveLinkFromStorage;*@
    </script>

    <script src="~/Scripts/popper.min.js"></script>
    <script src="~/Scripts/sweetalert2.min.js"></script>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
    @RenderSection("styles", required: false)
</body>
</html>
