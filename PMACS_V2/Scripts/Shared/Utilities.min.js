function refreshAccessToken(){var t=localStorage.getItem("Logout"),n=localStorage.getItem("refreshToken");return n?fetch("/User/RefreshToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:n})}).then(function(n){return n.json().then(function(i){return n.ok&&i.accessToken?(localStorage.setItem("accessToken",i.accessToken),!0):(console.warn("Refresh token failed. Logging out..."),localStorage.clear(),window.location.href=t,!1)})}).catch(function(n){return console.error("Error refreshing token:",n),!1}):Promise.resolve(!1)}function getMonthString(n){return{MonthUpload:"MonthUpload",Total:"Total","1":"Jan","2":"Feb","3":"Mar","4":"Apr","5":"May","6":"Jun","7":"Jul","8":"Aug","9":"Sep","10":"Oct","11":"Nov","12":"Dec"}[n]||""}function getRowMonths(n){var t=parseInt(n,10);return["January","February","March","April","May","June","July","August","September","October","November","December"][t-1]||""}function getMonthInteger(n){return{January:1,February:2,March:3,April:4,May:5,June:6,July:7,August:8,September:9,October:10,November:11,December:12}[n]||0}window.FetchAuthenticate=function(n,t){function r(n){return fetch(f,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}})}var i=localStorage.getItem("accessToken"),u=new URLSearchParams(t).toString(),f=n+"?"+u;return r(i).then(function(n){var t=localStorage.getItem("Logout");return n.status===401?refreshAccessToken().then(function(n){return n?(i=localStorage.getItem("accessToken"),r(i).then(function(n){return n.status===401?(localStorage.clear(),window.location.href=t,null):n.json()})):(localStorage.clear(),window.location.href=t,null)}):n.json()}).catch(function(n){console.error("Error fetching data:",n)})};window.fetchData=function(n,t){t=t||{};try{var i=new URLSearchParams(t).toString(),r=i?n+"?"+i:n;return fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(n){return n.json()}).catch(function(n){return console.error("Fetch Error:",n),null})}catch(u){return console.error("Fetch Error:",u),Promise.resolve(null)}};window.postData=function(n,t){return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(n){return n.json().then(function(n){return n}).catch(function(t){return console.error("Error parsing JSON:",t),n.text().then(function(n){return console.error("Raw response:",n),{Success:!1,Message:"Invalid JSON response",Raw:n}})})}).catch(function(n){return console.error("Error posting data:",n),null})};window.postPartialData=function(n,t){return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(n){if(!n.ok)throw new Error("HTTP error! Status: "+n.status);return n.text()}).catch(function(n){return console.error("Error posting data:",n),null})};window.PullUserInformation=function(){var n=localStorage.getItem("accessToken");return fetch("/User/GetUserInformation",{method:"POST",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}).then(function(n){return n.status===401?(console.warn("Unauthorized"),null):n.json()}).then(function(n){return n&&n.success?n:(n&&console.warn(n.message||"Unknown error"),null)})};window.ActionRestrict=function(){var n=localStorage.getItem("UserRole");if(n==="Leader"||n==="Users")return!1};window.IsLoginUser=function(n){var t,i,u,f,e,r;n=n||{};t={storageKey:"isLoggedInPMACS",expectedValue:"true",redirectUrl:"/P1SA/PMACS/Mainpage",redirectIfLoggedInUrl:null,expirationKey:null,maxHours:null};for(i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);if(u=localStorage.getItem(t.storageKey),u!==t.expectedValue){f=window.location.pathname;f!==t.redirectUrl&&(typeof ActionRestrict=="function"?(e=ActionRestrict(),e!==!1&&(window.location.href=t.redirectUrl)):window.location.href=t.redirectUrl);return}if(t.expirationKey&&t.maxHours)if(r=localStorage.getItem(t.expirationKey),r){var o=new Date(r),s=new Date,h=Math.abs(s-o)/36e5;h>t.maxHours&&(localStorage.clear(),window.location.pathname!==t.redirectUrl&&(window.location.href=t.redirectUrl))}else localStorage.clear(),window.location.pathname!==t.redirectUrl&&(window.location.href=t.redirectUrl)};window.logout=function(){var n=localStorage.getItem("Logout");return fetch("/User/Logout",{method:"POST"}).then(function(){localStorage.clear();window.location.href=n}).catch(function(n){console.error("Logout failed:",n)})};window.restrictChars=function(n){var t=n.which||n.keyCode;return t>=48&&t<=57||t===46};