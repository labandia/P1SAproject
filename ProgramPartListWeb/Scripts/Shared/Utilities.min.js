function refreshAccessToken(){var t=localStorage.getItem("Logout"),n=localStorage.getItem("refreshToken");return n?fetch("/User/RefreshToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:n})}).then(function(n){return n.json().then(function(i){return n.ok&&i.accessToken?(localStorage.setItem("accessToken",i.accessToken),!0):(console.warn("Refresh token failed. Logging out..."),localStorage.clear(),window.location.href=t,!1)})}).catch(function(n){return console.error("Error refreshing token:",n),!1}):Promise.resolve(!1)}window.FetchAuthenticate=function(n,t){function u(n){return fetch(f,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}})}var i=localStorage.getItem("accessToken"),r=Object.keys(t||{}).map(function(n){return encodeURIComponent(n)+"="+encodeURIComponent(t[n])}).join("&"),f=n+(r?"?"+r:"");return u(i).then(function(n){var t=localStorage.getItem("Logout");return n.status===401?refreshAccessToken().then(function(n){return n?(i=localStorage.getItem("accessToken"),u(i).then(function(n){return n.status===401?(localStorage.clear(),window.location.href=t,null):n.json()})):(localStorage.clear(),window.location.href=t,null)}):n.json()}).catch(function(n){console.error("Error fetching data:",n)})};window.fetchData=function(n,t){t===void 0&&(t={});console.clear();var i=Object.keys(t||{}).map(function(n){return encodeURIComponent(n)+"="+encodeURIComponent(t[n])}).join("&"),r=i?n+"?"+i:n;return fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(n){return n.json()}).catch(function(n){return console.error("Fetch Error:",n),null})};window.postData=function(n,t){return console.clear(),fetch(n,{method:"POST",body:t}).then(function(n){return n.json().then(function(t){return n.ok&&t.Success!==!1||console.error("Server error:",t.Message||"Unknown error"),t})}).catch(function(n){return console.error("Error posting data:",n),null})};window.postrawData=function(n,t){return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(n){return n.json().then(function(t){return n.ok&&t.Success!==!1||console.error("Server error:",t.Message||"Unknown error"),t}).catch(function(t){return console.error("Error parsing JSON:",t),n.text().then(function(n){return console.error("Raw response:",n),{Success:!1,Message:"Invalid JSON response",Raw:n}})})}).catch(function(n){return console.error("Error posting data:",n),null})};window.PullUserInformation=function(){var n=localStorage.getItem("accessToken");return fetch("/User/GetUserInformation",{method:"POST",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}).then(function(n){if(n.status===401){console.warn("Unauthorized");return}return n.json().then(function(n){if(n.success)return console.log("User ID:",n.userId),console.log("Name:",n.name),console.log("Role:",n.role),n;console.warn(n.message||"Unknown error")})})};window.IsLoginUser=function(n){var f,s,h;n=n||{};var v=n.storageKey||"isLoggedInPatrol",e=n.expectedValue||"true",t=n.redirectUrl||"/PC/Patrol/index",u=n.redirectIfLoggedInUrl||null,i=n.expirationKey||null,r=n.maxHours||null,o=localStorage.getItem(v);if(o===e&&u)if(i&&r){if(f=localStorage.getItem(i),f){var y=new Date(f),p=new Date,w=Math.abs(p-y)/36e5;if(w<=r){window.location.href=u;return}}}else{window.location.href=u;return}if(o!==e){if(s=window.location.pathname,s!==t)if(typeof ActionRestrict=="function"){if(h=ActionRestrict(),h!==!1){window.location.href=t;return}}else{window.location.href=t;return}return}if(i&&r){var c=localStorage.getItem(i),l=window.location.pathname,a=new URL(t,window.location.origin).pathname;if(c){var b=new Date(c),k=new Date,d=Math.abs(k-b)/36e5;d>r&&(localStorage.clear(),l!==a&&(window.location.href=t))}else localStorage.clear(),l!==a&&(window.location.href=t)}};window.logout=function(){var n=localStorage.getItem("Logout");try{localStorage.clear();window.location.href=n}catch(t){console.error("Logout failed:",t)}};window.restrictChars=function(n){var t=n.which||n.keycode;return t>=48&&t<=57||t===46};